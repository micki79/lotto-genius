name: ğŸ€ LottoGenius Multi-KI Analyse

on:
  schedule:
    # Nach Mittwochs-Ziehung (18:25) - lÃ¤uft um 20:00 CET
    - cron: '0 19 * * 3'
    # Nach Samstags-Ziehung (19:25) - lÃ¤uft um 21:00 CET
    - cron: '0 20 * * 6'
    # Sonntag 03:00 - WÃ¶chentliche Optimierung
    - cron: '0 2 * * 0'
  workflow_dispatch:  # Manueller Start mÃ¶glich

jobs:
  analyze:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    
    env:
      # KI-API Keys aus GitHub Secrets
      GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
      GROQ_API_KEY: ${{ secrets.GROQ_API_KEY }}
      HUGGINGFACE_API_KEY: ${{ secrets.HUGGINGFACE_API_KEY }}
      OPENROUTER_API_KEY: ${{ secrets.OPENROUTER_API_KEY }}
      TOGETHER_API_KEY: ${{ secrets.TOGETHER_API_KEY }}
      DEEPSEEK_API_KEY: ${{ secrets.DEEPSEEK_API_KEY }}
    
    steps:
      - name: ğŸ“¥ Repository auschecken
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: ğŸ Python einrichten
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      - name: ğŸ“¦ Dependencies installieren
        run: |
          pip install requests numpy

      - name: ğŸ° Lotto-Daten aktualisieren
        run: python scripts/fetch_data.py

      - name: ğŸ“Š KI-Analyse durchfÃ¼hren
        run: python scripts/analyze.py

      - name: ğŸ§  Aus Vorhersagen lernen
        run: python scripts/learn.py

      - name: ğŸ”® Neue Multi-KI Vorhersagen generieren
        run: python scripts/predict.py

      - name: ğŸ“¤ Ã„nderungen committen
        run: |
          git config --local user.email "lotto-genius-bot@github.com"
          git config --local user.name "ğŸ€ LottoGenius Bot"
          git add -A
          
          # PrÃ¼fe ob es Ã„nderungen gibt
          if git diff --quiet && git diff --staged --quiet; then
            echo "Keine Ã„nderungen zum committen"
          else
            git commit -m "ğŸ¤– Auto-Update: $(date '+%Y-%m-%d %H:%M') 

ğŸ“Š Neue Lotto-Daten geholt
ğŸ§  KI-Analyse durchgefÃ¼hrt  
ğŸ”® Vorhersagen generiert
ğŸ“ˆ Lernsystem aktualisiert"
            git push
          fi
